:root {
  --bg1: #0f172a;
  --bg2: #1e293b;
  --primary: #7c3aed;
  --primary-600: #6d28d9;
  --danger: #ef4444;
  --muted: #94a3b8;
  --glass: rgba(255,255,255,0.08);
  --warn: #f59e0b;
}

* { box-sizing: border-box; }
html, body, #root { height: 100%; }
body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji"; overflow: hidden; }

.ct-root { min-height: 100vh; background: radial-gradient(1000px 600px at 20% -10%, #201f42 0%, transparent 70%), radial-gradient(800px 400px at 100% 0%, #2b194f 0%, transparent 70%), linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%); color: #e5e7eb; position: relative; }

.ct-banner { position: sticky; top: 0; z-index: 20; background: rgba(245, 158, 11, 0.12); border-bottom: 1px solid rgba(245,158,11,0.35); color: #fde68a; padding: 10px 16px; text-align: center; font-size: 13px; backdrop-filter: blur(6px); }

.ct-bg-video { position: fixed; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.15; pointer-events: none; z-index: 0; }

.ct-header { text-align: center; padding: 28px 16px 8px; position: relative; z-index: 1; }
.ct-header-row { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
.ct-header-actions { display: flex; align-items: center; gap: 10px; }
.ct-title { font-size: 28px; font-weight: 800; letter-spacing: 0.2px; }
.ct-sub { font-size: 14px; color: var(--muted); margin-top: 6px; }

/* Advanced Settings Panel */
.ct-settings-panel { position: fixed; top: 0; right: 0; width: min(450px, 90vw); height: 100vh; background: rgba(15,23,42,0.95); border-left: 1px solid rgba(148,163,184,0.12); backdrop-filter: blur(12px); z-index: 30; overflow-y: auto; }
.ct-settings-content { padding: 20px; }
.ct-settings-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
.ct-settings-header h3 { margin: 0; font-size: 18px; }
.ct-settings-section { margin-bottom: 24px; }
.ct-settings-section h4 { margin: 0 0 12px 0; font-size: 14px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }

/* Extension Manager */
.ct-extension-manager { background: rgba(2,6,23,0.6); border: 1px solid rgba(148,163,184,0.12); border-radius: 12px; padding: 16px; }
.ct-section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
.ct-section-header span { font-size: 16px; font-weight: 600; }
.ct-add-extension-form { display: flex; gap: 8px; margin-bottom: 12px; }
.ct-add-extension-form input { flex: 1; height: 36px; }
.ct-extensions-list { display: flex; flex-direction: column; gap: 8px; }
.ct-extension-item { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; }
.ct-extension-info { display: flex; flex-direction: column; gap: 2px; }
.ct-extension-name { font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 6px; }
.ct-extension-status { font-size: 12px; opacity: 0.8; }
.ct-extension-controls { display: flex; gap: 6px; }
.ct-empty-extensions { text-align: center; padding: 16px; color: var(--muted); font-size: 13px; }
.ct-pre-installed { color: var(--warn); font-size: 12px; }

/* Button sizes */
.ct-small-btn { height: 36px; font-size: 13px; padding: 0 12px; }
.ct-tiny-btn { height: 28px; font-size: 12px; padding: 0 8px; }

/* Draggable Session Controls */
.ct-session-controls-draggable { position: fixed; z-index: 60; background: rgba(2,6,23,0.95); border: 1px solid rgba(255,255,255,0.14); border-radius: 12px; padding: 8px; backdrop-filter: blur(8px); cursor: move; transition: opacity 0.3s ease, transform 0.2s ease; display: flex; align-items: center; gap: 8px; }
.ct-session-controls-draggable.hidden { opacity: 0; pointer-events: none; }
.ct-session-controls-draggable.visible { opacity: 1; pointer-events: auto; }
.ct-session-controls-draggable.dragging { transform: scale(1.02); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

.ct-drag-handle { color: var(--muted); font-size: 16px; cursor: grab; padding: 4px; user-select: none; }
.ct-drag-handle:active { cursor: grabbing; }

.ct-controls-buttons { display: flex; gap: 6px; }

/* Modal Components */
.ct-modal-overlay { position: fixed; inset: 0; z-index: 100; display: grid; place-items: center; background: rgba(0,0,0,0.8); backdrop-filter: blur(4px); }
.ct-modal-content { background: rgba(15,23,42,0.95); border: 1px solid rgba(148,163,184,0.12); border-radius: 16px; min-width: 400px; max-width: 90vw; max-height: 90vh; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
.ct-modal-header { display: flex; align-items: center; justify-content: space-between; padding: 20px 24px 0 24px; }
.ct-modal-header h3 { margin: 0; font-size: 18px; }
.ct-modal-body { padding: 24px; }
.ct-modal-footer { display: flex; gap: 12px; justify-content: flex-end; padding: 0 24px 24px 24px; }

/* Icon Uploader */
.ct-icon-uploader { background: rgba(2,6,23,0.6); border: 1px solid rgba(148,163,184,0.12); border-radius: 12px; padding: 16px; }
.ct-icon-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 8px; }
.ct-icon-option { width: 60px; height: 60px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.06); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
.ct-icon-option:hover { border-color: rgba(255,255,255,0.3); transform: scale(1.02); }
.ct-icon-option.selected { border-color: var(--primary); background: rgba(124, 58, 237, 0.2); }
.ct-icon-emoji { font-size: 24px; }
.ct-uploaded-icon { width: 40px; height: 40px; object-fit: cover; border-radius: 8px; }
.ct-icon-upload-btn { background: rgba(124, 58, 237, 0.2); border-color: var(--primary); color: var(--primary); font-size: 24px; font-weight: 700; }

/* Custom App Icons */
.ct-app-custom-icon { width: 24px; height: 24px; object-fit: cover; border-radius: 4px; }

/* Timeout Warning Modal */
.ct-timeout-modal { position: fixed; inset: 0; z-index: 100; display: grid; place-items: center; background: rgba(0,0,0,0.8); backdrop-filter: blur(4px); }
.ct-timeout-content { background: rgba(15,23,42,0.95); border: 1px solid rgba(148,163,184,0.12); border-radius: 16px; padding: 32px; text-align: center; max-width: 400px; margin: 20px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
.ct-timeout-icon { font-size: 48px; margin-bottom: 16px; }
.ct-timeout-content h3 { margin: 0 0 16px 0; font-size: 24px; }
.ct-timeout-content p { margin: 0 0 24px 0; color: var(--muted); line-height: 1.5; }
.ct-timeout-buttons { display: flex; gap: 12px; justify-content: center; }

/* Multicursor */
.ct-multicursor-overlay { position: absolute; inset: 0; pointer-events: none; z-index: 70; }
.ct-cursor { position: absolute; pointer-events: none; transition: all 0.1s ease; }
.ct-cursor-pointer { width: 12px; height: 19px; color: #8b5cf6; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
.ct-cursor-label { position: absolute; top: 20px; left: 0; background: #8b5cf6; color: white; font-size: 11px; padding: 2px 6px; border-radius: 4px; white-space: nowrap; font-weight: 600; }

/* Desktop */
.ct-desktop { position: fixed; inset: 0; z-index: 1; padding-top: 100px; pointer-events: none; }
.ct-desktop > * { pointer-events: auto; }

/* Draggable Apps */
.ct-app-icon { width: 100px; height: 100px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.22); display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(0,0,0,0.35); cursor: grab; transition: all 0.2s ease; padding: 8px; user-select: none; }
.ct-app-icon:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 14px 36px rgba(0,0,0,0.45); border-color: rgba(255,255,255,0.35); }
.ct-app-icon:active { transform: scale(0.98); }

.ct-draggable-app { position: absolute; }
.ct-draggable-app.dragging { cursor: grabbing; z-index: 1000; }

.ct-app-icon-content { display: flex; flex-direction: column; align-items: center; gap: 6px; }
.ct-app-icon-symbol { font-size: 24px; font-weight: 800; filter: drop-shadow(0 2px 6px rgba(0,0,0,0.4)); }
.ct-app-icon-name { font-size: 11px; font-weight: 600; color: #ffffff; text-align: center; text-shadow: 0 1px 3px rgba(0,0,0,0.5); line-height: 1.2; }

.ct-remove-app { position: absolute; top: -6px; right: -6px; width: 20px; height: 20px; border-radius: 50%; background: var(--danger); color: white; border: none; cursor: pointer; font-size: 14px; font-weight: 700; display: flex; align-items: center; justify-content: center; z-index: 10; box-shadow: 0 2px 6px rgba(0,0,0,0.4); }
.ct-remove-app:hover { background: #dc2626; transform: scale(1.1); }

/* Session View */
.ct-session-view { position: fixed; inset: 0; z-index: 10; background: #000; }

.ct-browser-container { width: 100%; height: 100%; position: relative; }
.ct-browser-fullscreen { position: fixed; inset: 0; z-index: 40; }

.ct-browser { width: 100%; height: 100%; position: relative; background: #000; }

.ct-browser-iframe { width: 100%; height: 100%; border: 0; background: #000; object-fit: cover; }

.ct-hyperbeam-mount { width: 100%; height: 100%; background: #000; }
.ct-hyperbeam-mount > * { width: 100% !important; height: 100% !important; object-fit: cover !important; }

.ct-session-info { position: absolute; bottom: 20px; left: 20px; background: rgba(16,185,129,0.12); border: 1px solid rgba(16,185,129,0.35); color: #bbf7d0; font-size: 11px; padding: 6px 10px; border-radius: 8px; font-weight: 600; z-index: 50; max-width: calc(100vw - 40px); }

/* Video Chat Heads */
.ct-video-chat-head { position: absolute; z-index: 50; border-radius: 50%; display: grid; place-items: center; box-shadow: 0 10px 25px rgba(0,0,0,0.35); border: 2px solid rgba(255,255,255,0.3); user-select: none; touch-action: none; overflow: hidden; }

.ct-video-stream { border-radius: 50%; object-fit: cover; }

.ct-video-controls { position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); display: flex; gap: 4px; opacity: 0; transition: opacity 0.2s ease; }
.ct-video-chat-head:hover .ct-video-controls { opacity: 1; }

.ct-video-btn { width: 24px; height: 24px; border-radius: 50%; border: none; cursor: pointer; font-size: 10px; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.8); color: white; transition: all 0.2s ease; }
.ct-video-btn:hover { background: rgba(0,0,0,0.9); transform: scale(1.1); }
.ct-video-btn.active { background: var(--primary); }

.ct-muted-indicator { position: absolute; top: 4px; right: 4px; background: rgba(239,68,68,0.9); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 10px; }

.ct-video-active { border-color: var(--primary); box-shadow: 0 10px 25px rgba(0,0,0,0.35), 0 0 0 2px rgba(124, 58, 237, 0.5); }

/* Chat head (legacy) */
.ct-chat-head { position: absolute; z-index: 50; border-radius: 9999px; display: grid; place-items: center; box-shadow: 0 10px 25px rgba(0,0,0,0.35); border: 2px solid rgba(255,255,255,0.3); user-select: none; touch-action: none; }
.ct-chat-initial { font-weight: 800; color: white; text-shadow: 0 2px 8px rgba(0,0,0,0.5); }
.ct-resizer { position: absolute; right: -6px; bottom: -6px; width: 16px; height: 16px; border-radius: 4px; background: rgba(255,255,255,0.8); box-shadow: 0 2px 6px rgba(0,0,0,0.3); cursor: nwse-resize; }

/* Chat panel */
.ct-chat-panel { position: absolute; left: 12px; bottom: 12px; z-index: 55; display: flex; flex-direction: column; gap: 8px; }
.ct-chat-panel-fullscreen { position: fixed; left: 20px; bottom: 20px; right: 20px; width: auto; max-width: 400px; }
.ct-chat-window { width: min(360px, 90vw); background: rgba(2,6,23,0.9); border: 1px solid rgba(255,255,255,0.14); border-radius: 12px; overflow: hidden; backdrop-filter: blur(8px); }
.ct-chat-messages { max-height: 200px; overflow: auto; padding: 12px; display: flex; flex-direction: column; gap: 8px; }
.ct-chat-item { display: flex; gap: 8px; align-items: center; font-size: 14px; }
.ct-chat-tag { width: 24px; height: 24px; border-radius: 9999px; display: inline-grid; place-items: center; color: white; font-size: 12px; flex-shrink: 0; }
.ct-chat-text { color: #e5e7eb; }
.ct-chat-empty { text-align: center; padding: 12px; color: var(--muted); font-size: 13px; }
.ct-chat-input { display: flex; gap: 8px; border-top: 1px solid rgba(255,255,255,0.1); padding: 8px; }
.ct-chat-input input { flex: 1; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.14); border-radius: 8px; height: 38px; color: #e5e7eb; padding: 0 12px; }

/* Form elements */
.ct-field { display: flex; flex-direction: column; margin-bottom: 12px; }
.ct-field label { font-size: 12px; color: var(--muted); margin-bottom: 6px; }
.ct-field input, .ct-field select { background: rgba(2,6,23,0.6); color: #e5e7eb; border: 1px solid rgba(148,163,184,0.18); border-radius: 10px; height: 42px; padding: 0 12px; outline: none; }
.ct-field input:focus, .ct-field select:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.25); }

.ct-toggle { display: inline-flex; align-items: center; gap: 8px; font-size: 13px; color: #cbd5e1; margin-bottom: 12px; }

.ct-join { display: flex; gap: 8px; }
.ct-join input { flex: 1; }

.btn { height: 42px; border-radius: 10px; border: 1px solid transparent; padding: 0 14px; font-weight: 700; cursor: pointer; font-size: 14px; }
.btn.primary { background: var(--primary); color: white; }
.btn.primary:hover { background: var(--primary-600); }
.btn.danger { background: var(--danger); color: white; }
.btn.ghost { background: rgba(255,255,255,0.08); color: #e5e7eb; border-color: rgba(255,255,255,0.14); }
.btn:disabled { opacity: 0.6; cursor: not-allowed; }

.ct-alert { margin-top: 10px; border-radius: 10px; padding: 10px 12px; font-size: 13px; }
.ct-alert.error { background: rgba(239,68,68,0.12); border: 1px solid rgba(239,68,68,0.35); color: #fecaca; }
.ct-alert.success { background: rgba(16,185,129,0.12); border: 1px solid rgba(16,185,129,0.35); color: #bbf7d0; }

/* Quick background selector */
.ct-bg-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(60px, 1fr)); gap: 8px; margin-bottom: 12px; }
.ct-bg-thumb { width: 100%; height: 45px; border-radius: 8px; border: 2px solid rgba(255,255,255,0.1); background-size: cover; background-position: center; cursor: pointer; display: flex; align-items: end; transition: all 0.2s ease; position: relative; overflow: hidden; }
.ct-bg-thumb:hover { border-color: rgba(255,255,255,0.3); transform: scale(1.02); }
.ct-bg-thumb.active { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(124, 58, 237, 0.3); }
.ct-bg-name { background: rgba(0,0,0,0.7); color: white; font-size: 9px; padding: 2px 4px; border-radius: 4px 4px 0 0; width: 100%; text-align: center; font-weight: 600; }

.ct-mock-label { position: absolute; top: 10px; left: 10px; background: rgba(245, 158, 11, 0.18); border: 1px solid rgba(245,158,11,0.45); color: #fde68a; font-weight: 700; padding: 4px 8px; border-radius: 8px; letter-spacing: .6px; z-index: 60; }

.ct-footer { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); text-align: center; color: var(--muted); font-size: 12px; z-index: 2; white-space: nowrap; }

/* Mobile responsiveness */
@media (max-width: 768px) {
  .ct-settings-panel { width: 100vw; }
  .ct-app-icon { width: 80px; height: 80px; }
  .ct-app-icon-symbol { font-size: 20px; }
  .ct-app-icon-name { font-size: 10px; }
  .ct-bg-grid { grid-template-columns: repeat(auto-fit, minmax(50px, 1fr)); gap: 6px; }
  .ct-bg-thumb { height: 35px; }
  .ct-chat-panel-fullscreen { left: 10px; bottom: 10px; right: 10px; max-width: none; }
  .ct-timeout-content { margin: 10px; padding: 24px; }
  .ct-timeout-buttons { flex-direction: column; }
  .ct-session-info { font-size: 10px; padding: 4px 8px; }
  .ct-video-controls { bottom: -6px; }
  .ct-video-btn { width: 20px; height: 20px; font-size: 9px; }
  .ct-modal-content { min-width: 90vw; }
  .ct-icon-grid { grid-template-columns: repeat(auto-fill, minmax(50px, 1fr)); }
  .ct-icon-option { width: 50px; height: 50px; }
  .ct-session-controls-draggable { padding: 6px; }
  .ct-controls-buttons { gap: 4px; }
  .ct-controls-buttons .btn { height: 36px; font-size: 12px; padding: 0 10px; }
}